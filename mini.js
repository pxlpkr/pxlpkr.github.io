class Letter{constructor(t){this.char=t,this.status="WHITE",this.displaychar_="",this.yellows=[]}set displaychar(t){this.displaychar_=t}get displaychar(){return this.displaychar_.toUpperCase()}}class Word{constructor(t){this.word=t,this.letters=[];for(const n in t.split(""))this.letters.push(new Letter(n));this.orientation="H",this.yellow_chars=[],this.blue_chars=[]}}const baseBoxFontSize=56,minorBoxFontSize=16,alphabet="abcdefghijklmnopqrstuvwxyz";let clientX,clientY,dragging=!0,oldCanvasPosition=[],canvasPosition=[0,0],canvasScale=1,words={"h0,0":new Word("hello")};function drawSquare(t,n,e,a,o){t.fillStyle=n,t.fillRect(e,a,o,o)}function pose(t){return[canvasPosition[0]+80*t[0]*canvasScale,canvasPosition[1]+80*t[1]*canvasScale]}function aNudge(t,n,e=null){if(null!=e)return t[e]+=n,t;let a=[];for(const e of t)a.push(e+n);return a}function aMerge(t,n){for(let e=0;e<n.length;e++)t[e]+=n[e];return t}function aInv(t){for(let n=0;n<t.length;n++)t[n]=-t[n];return t}function matchColor(t){switch(t){case"WHITE":return"rgb(252,252,252)";case"GREEN":return"rgb(106,170,100)";case"RED":return"rgb(222,87,105)"}}function whList(t){return[t.width,-36.4*canvasScale]}function textBoxAlign(t){let n=whList(t);return[-n[0]/2-40*canvasScale,-n[1]/2+40*canvasScale]}function textCornerAlign(t){return[-whList(t)[0],78*canvasScale]}function setFont(t,n){t.font=Math.round(n*canvasScale)+"px Helvetica"}function drawToCanvas(){var t=document.getElementById("canvas");if(t.getContext){let n=t.getContext("2d");setFont(n,56),n.clearRect(0,0,t.width,t.height);for(const[t,e]of Object.entries(words)){let a=t.slice(1).split(",");a=[parseInt(a[0]),parseInt(a[1])];for(let t=0;t<e.letters.length;t++){const o=e.letters[t];let i=matchColor(o.status);drawSquare(n,"rgb(0,0,0)",...pose(a),80*canvasScale),drawSquare(n,i,...aNudge(pose(a),canvasScale),78*canvasScale),"H"==e.orientation?a[0]+=1:a[1]+=1,n.fillStyle="rgb(0,0,0";let s=textBoxAlign(n.measureText(o.displaychar));if(n.fillText(o.displaychar,...aMerge(pose(a),s)),"WHITE"==o.status&&o.yellows.length>0){setFont(n,16);for(let t=0;t<o.yellows.length;t++){let e=o.yellows[t],i=n.measureText(e.toUpperCase()),s=aNudge(textCornerAlign(i),-2);n.fillText(e.toUpperCase(),...aMerge(pose(a),aNudge(s,-i.width*t,0)))}setFont(n,56)}}}}}function fixCanvasSize(){body=document.body,html=document.documentElement,canvasHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight),canvas=document.getElementById("canvas"),canvas.width=document.body.clientWidth,canvas.height=.7*canvasHeight}document.addEventListener("mousedown",(function(t){0==t.button&&(clientX=t.clientX,clientY=t.clientY,oldCanvasPosition=[...canvasPosition],drawToCanvas(),dragging=!1)})),document.addEventListener("mouseup",(function(t){0==t.button&&(null!=clientX&&(clientX=void 0,clientY=void 0,drawToCanvas()),dragging||console.log("click!"))})),document.addEventListener("mousemove",(function(t){0==t.button&&null!=clientX&&(canvasPosition[0]=oldCanvasPosition[0]+(t.clientX-clientX),canvasPosition[1]=oldCanvasPosition[1]+(t.clientY-clientY),drawToCanvas(),dragging=!0)})),document.addEventListener("keydown",(function(t){t.key in alphabet&&null!=clientX&&(canvasPosition[0]=oldCanvasPosition[0]+(t.clientX-clientX),canvasPosition[1]=oldCanvasPosition[1]+(t.clientY-clientY),drawToCanvas(),dragging=!0)})),document.addEventListener("wheel",(function(t){let n=1.05;t.deltaY>0?canvasScale<2&&(canvasScale*=n,canvasPosition[0]=t.clientX-(t.clientX-canvasPosition[0])*n,canvasPosition[1]=t.clientY-(t.clientY-canvasPosition[1])*n):t.deltaY<0&&canvasScale>.5&&(canvasScale/=n,canvasPosition[0]=t.clientX-(t.clientX-canvasPosition[0])/n,canvasPosition[1]=t.clientY-(t.clientY-canvasPosition[1])/n),drawToCanvas()})),window.onload=function(){fixCanvasSize(),drawToCanvas()};